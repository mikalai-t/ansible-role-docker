---

# Note: set cache_valid_time=0 to ensure that an apt-get update after the added repo-key else you often get
# 'WARNING: The following packages cannot be authenticated!
# See also:
#   * http://askubuntu.com/questions/75565/why-am-i-getting-authentication-errors-for-packages-from-an-ubuntu-repository
- name: "docker-update-apt-cache"
  apt:
    update_cache: yes
    cache_valid_time: 0
  become: yes
  ignore_errors: yes

- name: "docker-clear-data-dir"
  file:
    path: /var/lib/docker
    state: absent
  become: yes

- name: "docker-reload-systemd"
  shell:
    cmd: "systemctl daemon-reload"
  args:
    warn: no
  become: yes

- name: "docker-stop-service"
  service:
    name: "{{ __docker_service_name }}"
    state: stopped
  become: yes

- name: "docker-restart-service"
  service:
    name: "{{ __docker_service_name }}"
    state: restarted
  become: yes
